// JavaScript Document

var isValidate=!0,checkForm=function(){var t=$("input[name='userName']"),i=$("input[name='password']"),n=$("span[id='ErrMessage']");return t.val()==""?(n.text("手机号码不能为空"),!1):i.val()==""?(n.text("密码不能为空"),!1):!0};$(function(){$("input[name='password']").blur(function(){var n=$(this),t=$("span[id='ErrMessage']");n.val()!=""&&(n.val().length<6||n.val().length>20?(t.text("密码长度在6~20之间"),isValidate=!1):(t.text(""),isValidate=!0))});$("#username,#password").keydown(function(n){n.keyCode==13&&$("#btnSubmit").click()});$("#btnSubmit").click(function(){if(checkForm()&&isValidate){var n=$("#hdBackurl").val();$.ajax({url:"/Login/Login",data:{UserName:$("#username").val(),Password:$.md5($("#password").val()),backurl:n},type:"POST",cache:!1,dataType:"json",success:function(t){if(t.isSuccess){if(n){location.href=n+"/login?id="+t.data.id;return}location.href=document.referrer.indexOf("Register")>0?"/User/Home/UserIndex":document.referrer==""?"/User/Home/UserIndex":document.referrer}else $("#ErrMessage").text(t.errMsg)}})}});$("#iPhone,#iPWD").keydown(function(n){n.keyCode==13&&$("#btnLogin").click()});$("#btnLogin").click(function(){checkForm()&&isValidate&&$.ajax({url:"/Login/Login1",data:{UserName:$("#iPhone").val(),Password:$.md5($("#iPWD").val())},type:"POST",cache:!1,dataType:"json",success:function(n){n.isSuccess?location.href="/Home/Index":$("#ErrMessage").text(n.errMsg)}})});$("#btnLogout").click(function(){$.post("/Login/Logout",{Action:"POST"},function(){window.location.reload()},"text")})});